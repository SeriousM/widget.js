<html>
<head>
	<title>Jasmine Spec Runner</title>
	<link type="text/css" rel="stylesheet" href="../../../Content/jasmine/jasmine.css">
		<script type="text/javascript" src="../../jquery-1.7.1.js"></script>
		<script type="text/javascript" src="../../../ViewScripts/ajaxclient.js"></script>
		<script type="text/javascript" src="../../jquery-ui-1.8.18.js"></script>
		<script type="text/javascript" src="../../jquery.validate.js"></script>
		<script type="text/javascript" src="../../jquery.crypt.js"></script>
		<script type="text/javascript" src="../../jquery.timeago.js"></script>
		<script type="text/javascript" src="../../jquery.tools.min.js"></script>
		<script type="text/javascript" src="../../jquery.json-2.3.js"></script>
		<script type="text/javascript" src="../../jstorage.js"></script>
		<script type="text/javascript" src="../../jquery.jeditable.js"></script>
		<script type="text/javascript" src="../../jsrender.js"></script>
		<!--		<script type="text/javascript" src="../../jquery-1.7.1-vsdoc.js"></script>-->
		<!-- include jasmine library -->
		<script type="text/javascript" src="../Frameworks/jasmine.js"></script>
		<script type="text/javascript" src="../Frameworks/reporters/jasmine-html.js"></script>
		<script type="text/javascript" src="../Frameworks/reporters/jasmine-junit.js"></script>
		<script type="text/javascript" src="../Frameworks/reporters/jasmine-teamcity.js"></script>
		<!-- include spec files here... -->
		<script type="text/javascript" src="../Specs/common.js"></script>
		<!--<script type="text/javascript" src="../Specs/apiclient.usertest.jasmine.js"></script>
		<script type="text/javascript" src="../Specs/apiclient.filetest.jasmine.js"></script>
		<script type="text/javascript" src="../Specs/apiclient.tenanttest.jasmine.js"></script>
		<script type="text/javascript" src="../Specs/apiclient.posttest.jasmine.js"></script>-->
		<script type="text/javascript" src="../Specs/widget.jasmine.js"></script>
		<script type="text/javascript" src="../../../ViewScripts/widget.js"></script>
		<!-- include apiClient -->
		<script src="../../../ViewScripts/ApiClient/apiclient.js" type="text/javascript"></script>
		<script src="../../../ViewScripts/ApiClient/apiclient.localization.js" type="text/javascript"></script>
		<script src="../../../ViewScripts/ApiClient/apiclient.auth.js" type="text/javascript"></script>
		<script src="../../../ViewScripts/ApiClient/apiclient.user.js" type="text/javascript"></script>
		<script src="../../../ViewScripts/ApiClient/apiclient.post.js" type="text/javascript"></script>
		<script src="../../../ViewScripts/ApiClient/apiclient.tenant.js" type="text/javascript"></script>
		<script src="../../../ViewScripts/ApiClient/apiclient.file.js" type="text/javascript"></script>
	</link>
</head>
<body>
	<textarea id="logger" style="display: none;"></textarea>
	<script type="text/javascript">
		(function () {
			console.log(jasmine.getEnv());

			var jasmineEnv = jasmine.getEnv();
			jasmineEnv.updateInterval = 1000;

			var htmlReporter = new jasmine.HtmlReporter();
			var junitReporter = new jasmine.JUnitXmlReporter();

			junitReporter.writeFile = function (filename, text) {
				$('#logger').text($('#logger').text() + '\r\n' + text);
			};

			jasmineEnv.addReporter(htmlReporter);
			jasmineEnv.addReporter(junitReporter);

			jasmineEnv.specFilter = function (spec) {
				return htmlReporter.specFilter(spec);
			};

			var currentWindowOnload = window.onload;

			window.onload = function () {
				if (currentWindowOnload) {
					currentWindowOnload();
				}
				execJasmine();
			};

			function execJasmine() {
				var oldCallback = jasmineEnv.currentRunner().finishCallback;
				jasmineEnv.currentRunner().finishCallback = function () {

					oldCallback.apply(this, arguments);

					console.log("jasmine oncomplete called");
					$('body').append($("<div  />", { tid: 'jasmineDoneIndicator' }));
				};

				jasmineEnv.execute();
			}
		})();
	</script>
</body>
</html>
